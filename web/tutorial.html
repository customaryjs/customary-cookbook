<!DOCTYPE html>
<head><title>Customary Tutorials</title></head>

<customary-tutorials-navigator></customary-tutorials-navigator>

<script type="application/json" data-customary-name="customary-tutorials-navigator">
    {
        "chapter_name": "Hello World",
        "tutorial_name": "~ with multiple components ~",
        "html": "../web/02-state/05/Customary-state-journey.html",
        "source_html": "https://github.com/arboliveira/customary-tutorials/blob/main/web/02-state/05/Customary-state-journey.html",
        "source_everything": "https://github.com/arboliveira/customary-tutorials/tree/main/web/02-state/05",
        "unit_test": "http://localhost:63342/customary-tutorials/web/test/test-ALL-the-things.html?grep=02\\x2dstate%2F05%2FCustomary\\x2dstate\\x2djourney\\.html",
        "previous_name": "Hello World",
        "next_name": "Hello World ~ with a slot ~"
    }
</script>

<template data-customary-name="external-link-symbol">&#x2B77;</template>

<template data-customary-name="customary-tutorials-navigator">

<div class="page-flex-container">

<div class="page-upper-item navigator-flex-container">

    <div class="navigator-left-half navigator-flex-item i1">
        <div class="logo">
        Customary<br>
        Tutorials
        </div>
        <p>Teach yourself Customary with examples</p>
        <hr/>
        <div class="action">
            <a target="_blank" data-bind="attr:{'href':html}">View in new tab <external-link-symbol /></a>
        </div>
        <div class="action">
            <a target="_blank" data-bind="attr:{'href':unit_test}">Unit Test <external-link-symbol /></a>
        </div>
        <div class="action">
            <a target="_blank" data-bind="attr:{'href':source_html}">Source: HTML <external-link-symbol /></a>
        </div>
        <div class="action">
            <a target="_blank" data-bind="attr:{'href':source_everything}">Source: Everything <external-link-symbol /></a>
        </div>
    </div>

    <div class="navigator-right-half navigator-flex-item tutorial-view-container">
        <div class="tutorial-header">
            <div class="tutorial-chapter">
                {this.state.chapter_name}
            </div>
            <div class="tutorial-name">
                {this.state.tutorial_name}
            </div>
            <div class="navigator-flex-container">
                <button class="previous">{this.state.previous_name} &lt;&lt;</button>
                <button class="next">&gt;&gt; {this.state.next_name}</button>
            </div>
        </div>
        <div class="tutorial-vision-container">
            <iframe data-bind="attr:{'src':html}"></iframe>
            <view-source data-bind="attr:{'src':html}"></view-source>
        </div>
    </div>

</div>

</div>

<style>
    .page-flex-container {
        display: flex;
        flex-direction: column;
        min-height: 98vh;
    }
    .page-upper-item {
        flex-grow: 1;
    }

    .navigator-flex-container {
        display: flex;
        justify-content: space-between;
        align-items: stretch;
        align-content: stretch;
    }
    .navigator-flex-item {
        border-style: dotted; border-width: 1px; border-color: lightgrey;
    }
    .navigator-left-half {
        flex-grow: 1;
    }
    .navigator-right-half {
        flex-grow: 2;
    }

    .logo {
        display: inline-block;
        font-family: serif; font-size: xxx-large; font-style: italic;
        border-style: double; border-radius: 16px;
        padding: 0px 14px 0px 14px;
    }
    .action {
        text-align: center;
        font-size: large;
        margin: 40px;
    }

    .tutorial-view-container {
        display: flex;
        flex-direction: column;
        align-items: stretch;
    }
    .tutorial-header {
        margin-bottom: 10px;
        padding-bottom: 10px;
        border-bottom-style: solid;
        border-bottom-width: 2px;
        border-bottom-color: grey;
    }
    .tutorial-chapter {
        font-size: xxx-large;
        text-align: center;
    }
    .tutorial-name {
        font-size: xx-large;
        text-align: center;
    }
    .tutorial-vision-container {
        flex-grow: 1;
        display: flex;
        align-items: stretch;
    }
    iframe {
        flex-grow: 1;
        border-style: none;
    }

    button {
        font-size: large;
    }
</style>

</template>

<template data-customary-name="view-source">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/styles/stackoverflow-light.min.css">
    <pre><code class="language-html" id="source_html"></code></pre>
</template>

<script type="importmap">{"imports": {
    "customary/": "../node_modules/customary/web/_script/",
    "highlight.js/": "../node_modules/highlight.js/es/",
    "knockout": "../node_modules/knockout/build/output/knockout-latest.debug.js"
}}</script>
<script type="module">
    (globalThis.customaryHooks ??= {})['customary-tutorials-navigator'] = {
        lifecycle: {connected: el => use_param_id(el)},
        events: [
            {
                selector: 'button.previous',
                listener: el => el.setState(state => ({
                    html: "../web/01-helloworld/01/Customary-helloworld.html",
                }))
            },
            {
                selector: 'button.next',
                listener: el => el.setState(state => ({
                    html: "../web/01-helloworld/04/Customary-helloworld-slot.html",
                }))
            }
        ]
    };

    import {CustomaryTutorialsData} from "./data/CustomaryTutorialsData.js";
    async function use_param_id(el) {
        const params = new URLSearchParams(window.location.search);
        const idParam = params.get("id");
        if (idParam === undefined) {
            return;
        }
        const data = await CustomaryTutorialsData.loadData();
        const tutorial = data.findById(idParam);
        const navigator = document.querySelector('customary-tutorials-navigator');
        navigator.setState(state => ({
            "chapter_name": "Hello World",
            "tutorial_name": "~ with multiple components ~",
            "html": tutorial.page_html,
            "source_html": tutorial.github_page_html,
            "source_everything": tutorial.github_dir,
            "unit_test": "./test/test-ALL-the-things.html?grep=" + encodeURIComponent(tutorial.page_html),
            "previous_name": "Hello World",
            "next_name": "Hello World ~ with a slot ~"
        }));
    }
</script>
<script type="module">
    (globalThis.customaryHooks ??= {})['view-source'] = {attributes: {src: (el,_,__,src) => viewSource(el, src)}};

    import highlight from 'https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/es/core.min.js';
    // does not work because should use "export default" but it's using "module.exports"
    //    import highlight from 'highlight.js/core.js';
    import html from 'highlight.js/languages/xml.js';
    highlight.registerLanguage('html', html);

    import {FetchText_DOM_singleton} from 'customary/fetch/FetchText.js';
    async function viewSource(el, src) {
        const codeElement = el.shadowRoot.getElementById("source_html");
        codeElement.textContent = await FetchText_DOM_singleton.fetchText(src);
        delete codeElement.dataset.highlighted;
        highlight.highlightElement(codeElement);
    }
</script>
<script type="module">import 'customary/go.js'</script>
